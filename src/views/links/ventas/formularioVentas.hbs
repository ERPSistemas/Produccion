

{{!-- formulario para dar de alta un pedido con los campos que se requieren segun las especificaciones dichas anteriormente --}}
<form action="/ventas/add" enctype="multipart/form-data" method="post" id="imgct" class="columinput">
   <div class="container">
      <div class="form-group row  justify-content-center ">
        <label for="oc" class="col-sm-2 col-form-label">Orden de Compra:</label>
        <div class="col-sm-6">
          <input type="text" class="form-control valid border border-secondary" name="orden" pattern="[a-zA-Z]+[0-9]+" title="Campo Obligatorio"required>
          {{!-- documento --}}
          {{!-- <div class="container"> --}}
            {{!-- <label>
                <svg xmlns="http://www.w3.org/2000/svg" class="iborrainputfile" width="20" height="17" viewBox="0 0 20 17">
                <path d="M10 0l-5.2 4.9h3.3v5.1h3.8v-5.1h3.3l-5.2-4.9zm9.3 11.5l-3.2-2.1h-2l3.4 2.6h-3.5c-.1 0-.2.1-.2.1l-.8 2.3h-6l-.8-2.2c-.1-.1-.1-.2-.2-.2h-3.6l3.4-2.6h-2l-3.2 2.1c-.4.3-.7 1-.6 1.5l.6 3.1c.1.5.7.9 1.2.9h16.3c.6 0 1.1-.4 1.3-.9l.6-3.1c.1-.5-.2-1.2-.7-1.5z"></path>
                </svg> --}}
              <input type="file" id="gimg" name="gimg" class="form-control-file" style="color: black" required /></center>
             {{!-- caso prueba para la oc pattern="^@?(/W){1,15}" --}}
             
              {{!-- </label> --}}
          {{!-- </div> --}}
          {{!-- fin de docuemnto --}}
        </div>
      </div>
      <div >
      <br>
      </div>

      <div class="form-group row justify-content-center">
        <label for="" class="col-sm-2 col-form-label">No. de Cotizacion:</label>
        <div class="col-sm-6">
          <input type="text"  class="form-control valid border border-secondary" name="numeroCotizacion"  title="Campo Obligatorio" required>
          {{!-- <div class="container"> --}}
            <input type="file" class="form-control-file " name="gimg" id="gimg" style="color: black;" required>
          {{!-- </div> --}}
        </div>
      </div>

      <br>
      <center>
       <div id="inputCliente"></div> 
      </center> 
     
      <div class="form-group row justify-content-center">
       
        <label for="" class="col-sm-2 col-form-label">Cliente:</label>
        <div class="col-sm-6">
          {{#each cliente }}
          <input type="text"  class="form-control border border-secondary" value="{{nombre}}" name="cliente" >
          {{/each}}
          {{!-- esta es la chida desde un principio --}}
          {{!-- <a class="btn btn-light btn-lg btn-block " data-toggle="modal" href="/ventas/busquedaCliente" role="button" aria-expanded="false" aria-controls="collapseExample">
            Tus Clientes
          </a> --}}

        {{!-- ventana emergente para Cliente --}}
        <button type="button" class="btn btn-light btn-lg btn-block " data-toggle="modal" data-target="#staticBackdrop"  href="/ventas/busquedaCliente" role="button" aria-expanded="false" aria-controls="collapseExample">
        Tus Clientes
        </button>
        </div>
      </div>

    
<!-- Modal -->
<div class="modal fade" id="staticBackdrop" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="staticBackdropLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="staticBackdropLabel">Options</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="col-sm-6">
     
         Busqueda Cliente <input type="text"  id="serch">
          <div id="clientesPorBusqueda" ></div>
          <div id="clientes">
          <table class="table table-bordered-responsive-sm">
           <thead class="thead-light">
           <tr>
             <th scope="col">NOMBRE</th>
             <th scope="col">ID</th>
             <th scope="col">BUSCAR</th>
           </tr>
         </thead>
           {{#each clientes}}
           <tr>
               <td>{{nombre}}</td>
               <td>{{numero_interno}}</td>
               <td> <center> <button type="button"  onclick="clientes('{{nombre}}')" class="btn btn-secondary" data-dismiss="modal">Seleccionar</button> </center>  </td>
           </tr>
           {{/each}}
         </table>
        </div>


        </div>
      </div>
      <div class="modal-footer">
        
        {{!-- <button type="button" class="btn btn-primary" data-dismiss="modal">Selecciona</button> --}}
      </div>
    </div>
  </div>
</div>

      <div class="form-group row justify-content-center">
        <label for=""  class="col-sm-2 col-form-label ">Ruta:</label>
        <div class="col-sm-6">
        <select class="form-control border border-secondary "  name="ruta" >
          <option value="1">Norte</option>
          <option value="2">Sur</option>
        </select>
        </div>
      </div> 


      <div class="form-group row justify-content-center">
        <label for="" class="col-sm-2 col-form-label">Importe:</label>
        <div class="col-sm-6">
          <div class="input-group-prepend">
          <span class="input-group-text border border-secondary" >$</span>
          <input type="number"  class="form-control border border-secondary" name="importe" required pattern="[0-9]{1,2}"  >
        </div>
        </div>
      </div>
{{!-- pattern de importe validacion un numero entero decimal entre 1 y 2 digitos  --}}
      <div class="form-group row justify-content-center">
        <label for="" class="col-sm-2 col-form-label" >Observaciones:</label>
        <div class="col-sm-6">
        <textarea class="form-control border border-secondary"  name="observaciones" title="En caso de ques sea necesario poner observaciones" rows="4"></textarea>
      </div>
      </div>

      <br>
      <div class="form-group row justify-content-center">
        <label for="" class="col-sm-2 col-form-label" ></label>
        <div class="col-sm-4">
          <input type="submit" class="btn btn-success btn-lg btn-block" value="Guardar" id="nvig" />
        </div>
      </div>
    </div> 
 </form>
 <script
  src="https://code.jquery.com/jquery-3.4.1.js"
  integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
  crossorigin="anonymous"></script>
<script type=" text/javascript">
    $('#clientesPorBusqueda').hide(); 
    $('#serch').keyup(function (e) {  
     if($('#serch').val()){ 
        let search = $('#serch').val();
        let data  = {
          clientes  : search
        }
        $.post("/profile", data,function (data) {
          console.log(data); 
            let tabla  = `<table class="table table-bordered-responsive-sm">
                <thead class="thead-light">
           <tr>
             <th scope="col">NOMBRE</th>
             <th scope="col">ID</th>
             <th scope="col">BUSCAR</th>
           </tr>
         </thead>`; 
            data.forEach(data => {
                tabla+= `
                  <tr>
                    <td>${data.nombre}</td>
                    <td>${data.numero_interno}</td>
                    <td> <button type="button"  onclick="clientes('${data.nombre}')" class="btn btn-secondary" data-dismiss="modal">Seleccionar</button></td>
                  </tr> 
                `
            });
            tabla  += "</table>"; 
            $("#clientes").hide(); 
            $("#clientesPorBusqueda").show();
            document.getElementById('clientesPorBusqueda').innerHTML  = tabla; 
            console.log(tabla); 
              
        });
     }
    }); 
    let clientes = (nombre)=>{
      let mandar  = `<label>Nombre del cliente</label>
      <input type="text" value="${nombre}" name="nombre"> `;
      document.getElementById('inputCliente').innerHTML =  mandar; 

    }
</script>